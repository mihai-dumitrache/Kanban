@using Kanban.Models
@using Microsoft.AspNetCore.Http
@model Kanban.Models.Board

@*
    Forleftformation on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@

<script src="https://kit.fontawesome.com/d5cb6dbe34.js" crossorigin="anonymous"></script>
<script>
function allowDrop(ev) {
  ev.preventDefault();
}

function drag(ev) {
  ev.dataTransfer.setData("text", ev.target.id);
}

function drop(ev) {
  ev.preventDefault();
  var data = ev.dataTransfer.getData("text");
  ev.target.appendChild(document.getElementById(data));
}
</script>
@*@{
    ViewData["Title"] = "Board";
}*@

<div>
Logged User: @Context.Session.GetString("_Email")
</div>

<h1>@ViewData["Board"]</h1>

Board Name: @Html.DisplayFor(model => model.Title) <br />
Board Description: @Html.DisplayFor(model => model.Description) <br />
Board Status: @Html.DisplayFor(model => model.ProjectStatus) <br />
Board Creator: @Html.DisplayFor(model => model.CreatedByUser.Name) <br />
@Html.HiddenFor(model => model.Id)
@Html.HiddenFor(model => model.UserBoards)

<div class="row" style="width:1500px">

  <div class="col-sm-2" style="border: thin solid black">New
    
    @foreach(var item in Model.TasksList)
    {
      @if ((int)item.Progress==0)
        {
         <div class="row">
            <div class="col" style="border: thin solid black" ondrop="drop(event)" ondragover="allowDrop(event)" draggable="true" ondragstart="drag(event)">@Html.DisplayFor(modelitem => item.Title)<br />
                     <p>&emsp;&emsp;&emsp;- @Html.DisplayFor(modelitem => item.Description)</p>
                     <i class="fas fa-info-circle" title="View Details" onclick="location.href='@Url.Action("ViewTask","Task",new {id=item.Id})'"></i>
            </div>
         </div>
        }
    }   
  </div>

  <div class="col-sm-2" style="border: thin solid black">In Progress
    
    @foreach(var item in Model.TasksList)
    {
      @if ((int)item.Progress==1)
        {
         <div class="row">
         <div class="col" style="border: thin solid black">@Html.DisplayFor(modelitem => item.Title)<br />
                      <p>&emsp;&emsp;&emsp;- @Html.DisplayFor(modelitem => item.Description)</p>
                     <i class="fas fa-info-circle" title="View Details" onclick="location.href='@Url.Action("ViewTask","Task",new {id=item.Id})'"></i>
                        </div>
         </div>
        }
    }   
  </div>

  <div class="col-sm-2" style="border: thin solid black">Testing
    
    @foreach(var item in Model.TasksList)
    {
      @if ((int)item.Progress==2)
        {
         <div class="row">
         <div class="col" style="border: thin solid black">@Html.DisplayFor(modelitem => item.Title)<br />
                       <p>&emsp;&emsp;&emsp;- @Html.DisplayFor(modelitem => item.Description)</p>
                     <i class="fas fa-info-circle" title="View Details" onclick="location.href='@Url.Action("ViewTask","Task",new {id=item.Id})'"></i>
                        </div>
         </div>
        }
    }   
  </div>

  <div class="col-sm-2" style="border: thin solid black">On Hold
    
    @foreach(var item in Model.TasksList)
    {
      @if ((int)item.Progress==3)
        {
         <div class="row">
         <div class="col" style="border: thin solid black">@Html.DisplayFor(modelitem => item.Title)<br />
                      <p>&emsp;&emsp;&emsp;- @Html.DisplayFor(modelitem => item.Description)</p>
                     <i class="fas fa-info-circle" title="View Details" onclick="location.href='@Url.Action("ViewTask","Task",new {id=item.Id})'"></i>
                        </div>
         </div>
        }
    }   
  </div>

  <div class="col-sm-2" style="border: thin solid black">Closed
    
    @foreach(var item in Model.TasksList)
    {
      @if ((int)item.Progress==4)
        {
         <div class="row">
         <div class="col" style="border: thin solid black">@Html.DisplayFor(modelitem => item.Title)<br />
                      <p>&emsp;&emsp;&emsp;- @Html.DisplayFor(modelitem => item.Description)</p>
                     <i class="fas fa-info-circle" title="View Details" onclick="location.href='@Url.Action("ViewTask","Task",new {id=item.Id})'"></i>
                        </div>
         </div>
        }
    }   
  </div>

</div>

<button type="submit" style="background-color: #4CAF60" onclick="location.href='@Url.Action("Index","Task",new {id=Model.Id})'" >Add Task</button>

<form asp-controller="User" asp-action="AddUserToBoard" method="post">
    <div class="form-group">
        <label name="userEmail" class="control-label">Add user to board</label>
        <input name="userEmail" class="form-control" type="email" placeholder="Insert User Email" id="userEmail"  />
        <hr><br />
        </div>
@Html.HiddenFor(model => model.Id)
<div class="has-error">
            @Html.ValidationMessage("UserNotFound")
            @Html.ValidationMessage("UserHasAccess")
            </div>
<button type="submit" class="btn btn-default">Add user</button>
</form>